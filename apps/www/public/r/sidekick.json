{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "sidekick",
  "title": "Sidekick",
  "description": "An AI chat sidebar component with conversation history, message bubbles, and integrated prompt input.",
  "dependencies": [
    "nanoid",
    "ai"
  ],
  "registryDependencies": [
    "button",
    "input",
    "separator",
    "sheet",
    "tooltip",
    "https://sidekick.montek.dev/r/prompt-input.json"
  ],
  "files": [
    {
      "path": "registry/new-york/blocks/sidekick/index.tsx",
      "content": "\"use client\";\n\nimport { cva, type VariantProps } from \"class-variance-authority\";\nimport { ArrowDownIcon, PanelLeftIcon } from \"lucide-react\";\nimport * as React from \"react\";\n\nimport { cn } from \"@/registry/new-york/lib/utils\";\nimport { Button } from \"@/registry/new-york/ui/button\";\nimport { Input } from \"@/registry/new-york/ui/input\";\nimport { Separator } from \"@/registry/new-york/ui/separator\";\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/registry/new-york/ui/sheet\";\nimport { TooltipProvider } from \"@/registry/new-york/ui/tooltip\";\n\nconst SIDEKICK_COOKIE_NAME = \"sidekick_state\";\nconst SIDEKICK_COOKIE_MAX_AGE = 60 * 60 * 24 * 7;\nconst SIDEKICK_WIDTH = \"24rem\";\nconst SIDEKICK_WIDTH_MOBILE = \"100%\";\nconst SIDEKICK_WIDTH_COLLAPSED = \"0rem\";\nconst SIDEKICK_KEYBOARD_SHORTCUT = \"i\";\n\ntype SidekickContextProps = {\n  state: \"expanded\" | \"collapsed\";\n  open: boolean;\n  setOpen: (open: boolean) => void;\n  openMobile: boolean;\n  setOpenMobile: (open: boolean) => void;\n  isMobile: boolean;\n  toggleSidekick: () => void;\n};\n\nconst SidekickContext = React.createContext<SidekickContextProps | null>(null);\n\nfunction useSidekick() {\n  const context = React.useContext(SidekickContext);\n  if (!context) {\n    throw new Error(\"useSidekick must be used within a SidekickProvider.\");\n  }\n  return context;\n}\n\n// Optional hook that returns null if no provider is present (for standalone mode)\nfunction useOptionalSidekick() {\n  return React.useContext(SidekickContext);\n}\n\nfunction useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState(false);\n\n  React.useEffect(() => {\n    const checkMobile = () => setIsMobile(window.innerWidth < 768);\n    checkMobile();\n    window.addEventListener(\"resize\", checkMobile);\n    return () => window.removeEventListener(\"resize\", checkMobile);\n  }, []);\n\n  return isMobile;\n}\n\ntype SidekickProviderProps = React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean;\n  defaultOpenMobile?: boolean;\n  open?: boolean;\n  onOpenChange?: (open: boolean) => void;\n};\n\nfunction SidekickProvider({\n  defaultOpen = true,\n  defaultOpenMobile = false,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: SidekickProviderProps) {\n  const isMobile = useIsMobile();\n  const [openMobile, setOpenMobile] = React.useState(defaultOpenMobile);\n\n  const [_open, _setOpen] = React.useState(defaultOpen);\n  const open = openProp ?? _open;\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value;\n      if (setOpenProp) {\n        setOpenProp(openState);\n      } else {\n        _setOpen(openState);\n      }\n      document.cookie = `${SIDEKICK_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEKICK_COOKIE_MAX_AGE}`;\n    },\n    [setOpenProp, open]\n  );\n\n  const toggleSidekick = React.useCallback(\n    () =>\n      isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open),\n    [isMobile, setOpen]\n  );\n\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEKICK_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault();\n        toggleSidekick();\n      }\n    };\n\n    window.addEventListener(\"keydown\", handleKeyDown);\n    return () => window.removeEventListener(\"keydown\", handleKeyDown);\n  }, [toggleSidekick]);\n\n  const state = open ? \"expanded\" : \"collapsed\";\n\n  const contextValue = React.useMemo<SidekickContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidekick,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidekick]\n  );\n\n  return (\n    <SidekickContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          className={cn(\"flex h-full min-h-svh w-full min-w-0\", className)}\n          data-slot=\"sidekick-wrapper\"\n          style={\n            {\n              \"--sidekick-width\": SIDEKICK_WIDTH,\n              \"--sidekick-width-collapsed\": SIDEKICK_WIDTH_COLLAPSED,\n              ...style,\n            } as React.CSSProperties\n          }\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidekickContext.Provider>\n  );\n}\n\ntype SidekickProps = React.ComponentProps<\"aside\"> & {\n  side?: \"left\" | \"right\";\n  mobileBehavior?: \"sheet\" | \"inline\" | \"floating\";\n  /** When true, renders as a standalone panel without toggle behavior */\n  standalone?: boolean;\n};\n\nfunction Sidekick({\n  side = \"right\",\n  mobileBehavior = \"sheet\",\n  standalone = false,\n  className,\n  children,\n  ...props\n}: SidekickProps) {\n  const context = useOptionalSidekick();\n\n  // Standalone mode: render as a simple panel without provider\n  if (standalone || !context) {\n    return (\n      <aside\n        className={cn(\n          \"flex h-full flex-col border-l bg-background text-foreground\",\n          side === \"left\" && \"border-r border-l-0\",\n          className\n        )}\n        data-side={side}\n        data-slot=\"sidekick\"\n        data-standalone=\"true\"\n        style={\n          {\n            \"--sidekick-width\": SIDEKICK_WIDTH,\n          } as React.CSSProperties\n        }\n        {...props}\n      >\n        <div className=\"flex h-full w-full flex-col\">{children}</div>\n      </aside>\n    );\n  }\n\n  const { isMobile, state, openMobile, setOpenMobile } = context;\n\n  if (isMobile && mobileBehavior === \"sheet\") {\n    return (\n      <Sheet onOpenChange={setOpenMobile} open={openMobile}>\n        <SheetContent\n          className=\"flex h-full w-full flex-col bg-background p-0 [&>button]:hidden\"\n          data-mobile=\"true\"\n          data-sidekick=\"panel\"\n          data-slot=\"sidekick\"\n          side={side}\n          style={\n            {\n              \"--sidekick-width\": SIDEKICK_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>AI Assistant</SheetTitle>\n            <SheetDescription>Chat with your AI assistant.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    );\n  }\n\n  if (isMobile && mobileBehavior === \"inline\") {\n    return (\n      <aside\n        className={cn(\n          \"flex w-full flex-col border-t bg-background text-foreground transition-[max-height,opacity] duration-200\",\n          openMobile\n            ? \"max-h-[75vh] opacity-100\"\n            : \"max-h-0 overflow-hidden opacity-0\",\n          className\n        )}\n        data-side={side}\n        data-slot=\"sidekick\"\n        data-state={openMobile ? \"expanded\" : \"collapsed\"}\n        {...props}\n      >\n        <div className=\"flex w-full flex-col\">{children}</div>\n      </aside>\n    );\n  }\n\n  if (isMobile && mobileBehavior === \"floating\") {\n    return (\n      <aside\n        className={cn(\n          \"absolute inset-y-0 right-0 flex w-full flex-col border-l bg-background text-foreground transition-transform duration-200\",\n          openMobile ? \"translate-x-0\" : \"translate-x-full\",\n          className\n        )}\n        data-side={side}\n        data-slot=\"sidekick\"\n        data-state={openMobile ? \"expanded\" : \"collapsed\"}\n        {...props}\n      >\n        <div className=\"flex h-full w-full flex-col\">{children}</div>\n      </aside>\n    );\n  }\n\n  return (\n    <aside\n      className={cn(\n        \"group peer hidden flex-col border-l bg-background text-foreground transition-[width] duration-200 ease-linear md:flex\",\n        state === \"expanded\" ? \"w-(--sidekick-width)\" : \"w-0 overflow-hidden\",\n        side === \"left\" && \"order-first border-r border-l-0\",\n        className\n      )}\n      data-side={side}\n      data-slot=\"sidekick\"\n      data-state={state}\n      {...props}\n    >\n      <div className=\"flex h-full w-(--sidekick-width) flex-col\">\n        {children}\n      </div>\n    </aside>\n  );\n}\n\nfunction SidekickTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const context = useOptionalSidekick();\n\n  // In standalone mode, trigger does nothing (or can be hidden)\n  if (!context) {\n    return null;\n  }\n\n  const { toggleSidekick } = context;\n\n  return (\n    <Button\n      className={cn(\"size-7\", className)}\n      data-sidekick=\"trigger\"\n      data-slot=\"sidekick-trigger\"\n      onClick={(event) => {\n        onClick?.(event);\n        toggleSidekick();\n      }}\n      size=\"icon\"\n      variant=\"ghost\"\n      {...props}\n    >\n      <PanelLeftIcon className=\"size-4\" />\n      <span className=\"sr-only\">Toggle AI Assistant</span>\n    </Button>\n  );\n}\n\nfunction SidekickHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      className={cn(\n        \"flex h-14 shrink-0 items-center gap-2 border-b px-4\",\n        className\n      )}\n      data-slot=\"sidekick-header\"\n      {...props}\n    />\n  );\n}\n\nfunction SidekickFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      className={cn(\"shrink-0 border-t p-4\", className)}\n      data-slot=\"sidekick-footer\"\n      {...props}\n    />\n  );\n}\n\nfunction SidekickContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      className={cn(\"flex min-h-0 flex-1 flex-col overflow-hidden\", className)}\n      data-slot=\"sidekick-content\"\n      {...props}\n    />\n  );\n}\n\nfunction SidekickInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      className={cn(\"relative flex min-w-0 flex-1 flex-col\", className)}\n      data-slot=\"sidekick-inset\"\n      {...props}\n    />\n  );\n}\n\nfunction SidekickSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      className={cn(\"mx-2 w-auto\", className)}\n      data-slot=\"sidekick-separator\"\n      {...props}\n    />\n  );\n}\n\nfunction SidekickInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      className={cn(\"h-8 w-full bg-background shadow-none\", className)}\n      data-slot=\"sidekick-input\"\n      {...props}\n    />\n  );\n}\n\ntype ConversationContextProps = {\n  scrollToBottom: () => void;\n  isAtBottom: boolean;\n};\n\nconst ConversationContext =\n  React.createContext<ConversationContextProps | null>(null);\n\nfunction useConversation() {\n  const context = React.useContext(ConversationContext);\n  if (!context) {\n    throw new Error(\"useConversation must be used within a Conversation.\");\n  }\n  return context;\n}\n\ntype ConversationProps = React.ComponentProps<\"div\">;\n\nfunction Conversation({ className, children, ...props }: ConversationProps) {\n  const scrollRef = React.useRef<HTMLDivElement>(null);\n  const [isAtBottom, setIsAtBottom] = React.useState(true);\n\n  const scrollToBottom = React.useCallback(() => {\n    if (scrollRef.current) {\n      scrollRef.current.scrollTo({\n        top: scrollRef.current.scrollHeight,\n        behavior: \"smooth\",\n      });\n    }\n  }, []);\n\n  const handleScroll = React.useCallback(() => {\n    if (scrollRef.current) {\n      const { scrollTop, scrollHeight, clientHeight } = scrollRef.current;\n      setIsAtBottom(scrollHeight - scrollTop - clientHeight < 50);\n    }\n  }, []);\n\n  React.useEffect(() => {\n    const scrollEl = scrollRef.current;\n    if (scrollEl) {\n      scrollEl.addEventListener(\"scroll\", handleScroll);\n      return () => scrollEl.removeEventListener(\"scroll\", handleScroll);\n    }\n  }, [handleScroll]);\n\n  // Auto-scroll when children change and user is at bottom\n  React.useEffect(() => {\n    if (isAtBottom) {\n      scrollToBottom();\n    }\n  }, [children, isAtBottom, scrollToBottom]);\n\n  const contextValue = React.useMemo(\n    () => ({ scrollToBottom, isAtBottom }),\n    [scrollToBottom, isAtBottom]\n  );\n\n  return (\n    <ConversationContext.Provider value={contextValue}>\n      <div\n        className={cn(\"relative flex-1 overflow-y-auto\", className)}\n        data-slot=\"conversation\"\n        ref={scrollRef}\n        role=\"log\"\n        {...props}\n      >\n        {children}\n      </div>\n    </ConversationContext.Provider>\n  );\n}\n\nfunction ConversationContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      className={cn(\"flex flex-col gap-4 p-4\", className)}\n      data-slot=\"conversation-content\"\n      {...props}\n    />\n  );\n}\n\ntype ConversationEmptyStateProps = React.ComponentProps<\"div\"> & {\n  title?: string;\n  description?: string;\n  icon?: React.ReactNode;\n};\n\nfunction ConversationEmptyState({\n  className,\n  title = \"No messages yet\",\n  description = \"Start a conversation to see messages here\",\n  icon,\n  children,\n  ...props\n}: ConversationEmptyStateProps) {\n  return (\n    <div\n      className={cn(\n        \"flex size-full flex-col items-center justify-center gap-3 p-8 text-center\",\n        className\n      )}\n      data-slot=\"conversation-empty-state\"\n      {...props}\n    >\n      {children ?? (\n        <>\n          {icon && <div className=\"text-muted-foreground\">{icon}</div>}\n          <div className=\"space-y-1\">\n            <h3 className=\"font-medium text-sm\">{title}</h3>\n            {description && (\n              <p className=\"text-muted-foreground text-sm\">{description}</p>\n            )}\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n\nfunction ConversationScrollButton({\n  className,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { isAtBottom, scrollToBottom } = useConversation();\n\n  if (isAtBottom) return null;\n\n  return (\n    <Button\n      className={cn(\n        \"absolute bottom-4 left-1/2 -translate-x-1/2 rounded-full\",\n        className\n      )}\n      data-slot=\"conversation-scroll-button\"\n      onClick={scrollToBottom}\n      size=\"icon\"\n      type=\"button\"\n      variant=\"outline\"\n      {...props}\n    >\n      <ArrowDownIcon className=\"size-4\" />\n    </Button>\n  );\n}\n\nconst messageVariants = cva(\"flex w-full gap-3\", {\n  variants: {\n    from: {\n      user: \"flex-row-reverse\",\n      assistant: \"flex-row\",\n    },\n  },\n  defaultVariants: {\n    from: \"assistant\",\n  },\n});\n\ntype MessageProps = React.ComponentProps<\"div\"> &\n  VariantProps<typeof messageVariants>;\n\nfunction Message({ className, from, children, ...props }: MessageProps) {\n  return (\n    <div\n      className={cn(messageVariants({ from }), className)}\n      data-from={from}\n      data-slot=\"message\"\n      {...props}\n    >\n      {children}\n    </div>\n  );\n}\n\nconst messageContentVariants = cva(\n  \"max-w-[85%] rounded-2xl px-4 py-2.5 text-sm\",\n  {\n    variants: {\n      from: {\n        user: \"rounded-br-md bg-primary text-primary-foreground\",\n        assistant: \"rounded-bl-md bg-muted text-foreground\",\n      },\n    },\n    defaultVariants: {\n      from: \"assistant\",\n    },\n  }\n);\n\ntype MessageContentProps = React.ComponentProps<\"div\"> &\n  VariantProps<typeof messageContentVariants>;\n\nfunction MessageContent({ className, from, ...props }: MessageContentProps) {\n  return (\n    <div\n      className={cn(messageContentVariants({ from }), className)}\n      data-from={from}\n      data-slot=\"message-content\"\n      {...props}\n    />\n  );\n}\n\nfunction MessageAvatar({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      className={cn(\n        \"flex size-8 shrink-0 items-center justify-center rounded-full bg-muted\",\n        className\n      )}\n      data-slot=\"message-avatar\"\n      {...props}\n    />\n  );\n}\n\nfunction MessageTimestamp({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) {\n  return (\n    <span\n      className={cn(\"text-muted-foreground text-xs\", className)}\n      data-slot=\"message-timestamp\"\n      {...props}\n    />\n  );\n}\n\nfunction MessageActions({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      className={cn(\n        \"flex items-center gap-1 opacity-0 transition-opacity group-hover:opacity-100\",\n        className\n      )}\n      data-slot=\"message-actions\"\n      {...props}\n    />\n  );\n}\n\nexport {\n  // Sidekick\n  Sidekick,\n  SidekickContent,\n  SidekickFooter,\n  SidekickHeader,\n  SidekickInset,\n  SidekickInput,\n  SidekickProvider,\n  SidekickSeparator,\n  SidekickTrigger,\n  useSidekick,\n  // Conversation\n  Conversation,\n  ConversationContent,\n  ConversationEmptyState,\n  ConversationScrollButton,\n  useConversation,\n  // Message\n  Message,\n  MessageActions,\n  MessageAvatar,\n  MessageContent,\n  MessageTimestamp,\n};\n\nSidekick.Header = SidekickHeader;\nSidekick.Content = SidekickContent;\nSidekick.Footer = SidekickFooter;\nSidekick.Inset = SidekickInset;\nSidekick.Input = SidekickInput;\nSidekick.Separator = SidekickSeparator;\nSidekick.Trigger = SidekickTrigger;\nSidekick.Provider = SidekickProvider;\n",
      "type": "registry:component"
    }
  ],
  "type": "registry:component"
}
